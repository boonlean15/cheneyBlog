# 协程 更轻量级的线程
- 空间和时间角度看，协程都比线程轻量的多
**协程**，简单的理解为更轻量级的线程。操作系统角度，线程在内核态中调度，协程在用户态中调度。协程切换成本更低
**协程**，协程有自己的栈，线程栈差不多1M，协程栈只有几K,或者几十K.

## Golang中的协程
Go、Python、Lua、Kotlin等都支持协程
- Golang实现ThreadPerMessage模式非常简单，其实越简单的模式，功能上就越稳定，可理解性就越好。
> Golang 实现的 echo 程序的服务端，用的是 Thread-Per-Message 模式，为每个成功建立连接的 socket 分配一个协程，相比 Java 线程池的实现方案，Golang 中协程的方案更简单。

## 利用协程实现同步
- java里使用多线程并发地处理IO,基本上用的都是异步非阻塞模型，这种模型的异步主要是靠注册回调函数实现
- 线程等待，本质上是一种严重的浪费，所以java的多线程不能使用同步处理，而对于协程来说，等待的成本就没有那么高，基于协程实现同步非阻塞是一个可行的方案

## 结构化并发编程
结构化程序，可以有分支，但最终一定要汇聚，不能有多个出口，因为这样他们组合起来才是线性的。
> goto会让程序变得混乱，混乱指代码书写顺序和执行顺序不一致，代码书写顺序代表我们的思维过程，书写顺序和执行顺序不一致，会干扰我们对代码的理解。我们的思维是线性的
- go语句让协程用起来太简单，也蕴藏风险。go语句类似goto语句
- goto语句可以随意穿越时空，被定义为**毒药**
- 结构化程序设计中，使用三种基本的控制结构来替代goto（顺序结构、选择结构、循环结构）
- 当开启一个新线程时，程序会并行的出现两个分支，主线程一个分支，子线程一个分支，天各一方，永不相见
> 三种基本的控制结构奠定了今天高级语言的基础，如果仔细观察这三种结构，你会发现它们的入口和出口只有一个，这意味它们是可组合的，而且组合起来一定是线性的，整体来看，代码的书写顺序和执行顺序也是一致的。

## 易用性
计算机里很多面向开发人员的技术，大多数都是在解决一个问题：易用性。协程作为一项并发编程技术，本质上也不过是解决并发工具的易用性问题而已

软件产品是否能够活下去：
- 最根本的是可读性好
> 好的代码，就像人民的艺术一样，应该是为人民群众服务的，只有根植于广大群众之中，才有生命力。




